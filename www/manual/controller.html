<!DOCTYPE html><html lang="de"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="manual.css"><title>controller</title></head><body>
<header>
	<p><a id="backlink" href="http://ftduino.de/"><font color="red">f</font><font color="blue">t</font><font color="darkcyan">Duino</font> Bedienungsanleitung</a> (<a href="https://harbaum.github.io/ftduino/manual.pdf">PDF-Version</a>)
</header>

<nav>
<a aria-current="page" href="controller.html">1.&nbsp;Controller</a> -
<a href="installation.html">2.&nbsp;Installation</a> -
<a href="ersteschritte.html">3.&nbsp;Erste Schritte</a> -
<a href="programmierung.html">4.&nbsp;Programmierung</a> -
<a href="schule.html">5.&nbsp;Schule</a> -
<a href="experimente.html">6.&nbsp;Experimente</a> -
<a href="modelle.html">7.&nbsp;Modelle</a> - 
<a href="community.html">8.&nbsp;Community</a> -
<a href="bibliotheken.html">9.&nbsp;Bibliotheken</a> -
<a href="aufbau.html">10.&nbsp;Aufbau</a>  -
<a href="anhang.html">Anhang</a>
</nav>
<h1><a id="1">1 Einleitung</a></h1>

<p>Elektronik- und Computermodule für Konstruktionsbaukästen gibt es seit
den Anfängen der privat genutzten Heimcomputer der 80er Jahre.  Diese
Module verfügten über wenig eigene Intelligenz und waren vor allem für
die Signalanpassung zwischen dem Heimcomputer und den Motoren und
Schaltern der Baukastensysteme zuständig, weshalb diese Module in der
Regel als ``Interfaces'' bezeichnet wurden, also als Schnittstelle
zwischen Computer und Modell.

<p>Über die Jahre stieg die Leistungsfähigkeit der Heimcomputer und auch
die Elektronik-Module lernten dazu. Vor allem wurden aus
``Interfaces'' über die Zeit ``Controller''. Aus den weitgehend
passiven Schnittstellen wurden Bausteine mit eigener Intelligenz, die
den Heimcomputer bzw. später den PC nur noch zur Programmierung
benötigten. Einmal programmiert konnten diese Controller das Modell
auch eigenständig bedienen. Dazu wurden die auf dem PC entwickelten
Programmdaten auf den Controller geladen und dort gespeichert.

<p>Die heutigen Controller von Lego oder fischertechnik sind selbst
leistungsfähige Computer. Um deren Komplexität für den Endanwender
benutzbar zu machen verbergen die Hersteller die Details der
elektronischen Komponenten sowie der auf den Geräten laufenden
Software hinter gefälligen Benutzeroberflächen. Leider verpassen solche
Systeme auf diese Weise die Chance, Wissen über Aufbau und Funktion
derartiger Controller zu vermitteln. Während sich die Hersteller
gegenseitig darin übertreffen, komplexe mechanische Getriebe im
Wortsinne begreifbar zu machen stellen sich die dazugehörigen
Controller für den Anwender als undurchsichtige Bausteine dar.

<p>Parallel hat sich seit der Jahrtausendwende die sogenannte
Maker-Bewegung entwickelt, die den ``Selbstmach''-Gedanken in den
Bereich der Elektronikentwicklung trägt. Systeme wie der Raspberry-Pi
und der Arduino laden dazu ein, alle technischen Details dieser
komplett zugänglichen und dokumentierten Controller zu erforschen und
eigene Entwicklungen zu betreiben. Große Communities bieten
umfangreiches Know-How und stellen Plattformen zum Wissensaustausch
zur Verfügung. Im Gegensatz zu den Controllern von fischertechnik und
Lego steht hier das Innere des Controllers im Vordergrund. Allerdings
erfordert der Einsatz dieser Controller oft einiges an handwerklichem
Geschick beim Aufbau der Elektronik selbst sowie speziell bei
Robotik-Projekten bei der Umsetzung von mechanischen Komponenten.

<p><h2><a id="1.1">1.1 Das <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>-Konzept</a></h2>

<p>Die Idee hinter dem <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> ist es, die Brücke zwischen zwei Welten
zu schlagen. Auf der einen Seite integriert er sich mechanisch und
elektrisch nahtlos in die Robotics-Serie der
fischertechnik-Konstruktionsbaukästen. Auf der anderen Seite fügt er
sich perfekt in das Arduino-Ökosystem zur Software-Entwicklung von
eingebetteten Systemen ein.

<figure id="IMG:1.1">
  
  <img src="controller/foto.jpg">
  <figcaption>Abbildung 1.1: <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span></figcaption>
</figure>

<p><h3><a id="1.1.1">1.1.1 Das fischertechnik-Baukastensystem</a></h3>

<p>Fischertechnik ist ein technikorientiertes Konstruktionsspielzeug.
Der Schwerpunkt liegt auf Mechanik, Elektromechanik, Elektronik und
zunehmend auch Robotik und der dafür nötigen Integration von
informationsverarbeitenden Komponenten.

<p>Fischertechnik selbst entwickelt und vertreibt seit den frühen 80er
Jahren Elektronik-Module, die eine Verbindung zwischen Computer und
mechanischem Modell ermöglichen bzw. über eigene Intelligenz
verfügen. Die dabei zum Einsatz kommenden Steckverbinder sowie die
Sensoren (Taster, Schalter, Lichtsensoren, ...) und Aktoren
(Lampen, Motoren, Ventile, ...) sind über die Jahre zueinander
kompatibel geblieben und lassen sich nach wie vor beliebig miteinander
kombinieren.

<p>Die letzten zwei Controller-Generationen (fischertechnik TX- und
TXT-Controller) haben eine vergleichbare mechanische Größe und
verfügen über eine vergleichbare Anzahl und Art von Anschlüssen zur
Verbindung mit dem Modell. Die Modelle aller aktuellen
Robotics-Baukästen sind auf diese Anschlüsse ausgelegt und 
untereinander kombinierbar.

<figure id="IMG:1.2">
  
  <figure><img src="controller/tx.jpg"><figcaption>(a) TX-Controller</figcaption></figure> 
  <figure><img src="controller/txt.jpg"><figcaption>(b) TXT-Controller</figcaption></figure>
  <figcaption>Abbildung 1.2: Original-Controller von fischertechnik</figcaption>
</figure>

<p>Beide Original-Controller verfügen über acht analoge Eingänge, acht
analoge Ausgänge, vier schnelle Zählereingänge und einen
I²C-Erweiterungsanschluss.

<p>Fischertechnik selbst vertreibt die PC-Software RoboPro zur visuellen
Softwareentwicklung für die hauseigenen Controller. Der Einstieg in
RoboPro ist relativ einfach und spricht bereits Kinder an. Die Grenzen
von RoboPro sind aber schnell erreicht, wenn es um praxisnahe und
inhaltlich anspruchsvolle Projekte in weiterführenden Schulen,
Universitäten und der Berufsausbildung geht. In diesen Bereichen haben
sich Systeme wie die Arduino-Plattform etabliert.

<p><h3><a id="1.1.2">1.1.2 Das Arduino-System</a></h3>

<p>Das Arduino-Ökosystem hat sich in den letzten Jahren zum
De-Facto-Standard für den Einstieg und die semiprofessionelle
Entwicklung und Programmierung von eingebetteten Systemen
etabliert. Eingebettete Systeme sind in der Regel mechanisch kleine
Computer und informationsverarbeitende Module, die innerhalb einer
Maschine Steuer- und Regelaufgaben übernehmen und immer häufiger auch
mit der Außenwelt kommunizieren.

<figure id="IMG:1.3">
  
  <figure><img src="controller/arduino_ide.png"><figcaption>(a) Arduino-Entwicklungsumgebung (IDE)</figcaption></figure> 
  <figure><img src="controller/leonardo.jpg"><figcaption>(b) Arduino-Leonardo-Controller</figcaption></figure>
  <figcaption>Abbildung 1.3: Die Arduino-Entwicklungsumgebung und -Controller</figcaption>
</figure>

<p>Die Arduino-IDE ist eine übersichtliche und leicht zu bedienende
Programmieroberfläche, die sich auf Windows-, Linux- und Apple-PCs
nutzen lässt. Die zu programmierenden Zielgeräte wie zum Beispiel der
Arduino-Leonardo sind kleine und kostengünstige Platinen, die per USB
mit dem PC verbunden werden. Sie kommen üblicherweise ohne Gehäuse und
stellen über Steckverbinder eine Vielzahl von Signalleitungen zum
Anschluss von Sensoren und Aktoren zur Verfügung. Typische mit der
Arduino-Plattform zu erledigende Aufgaben sind einfache
Messwerterfassungen (Temperatur-logging, ...) und Steueraufgaben
(Jalousiesteuerungen, ...).

<p>Programme, die mit der Arduino-IDE geschrieben wurden, werden in der
Arduino-Welt als sogenannte ``Sketches'' bezeichnet. Mit Hilfe der
Arduino-IDE können passende Sketches für den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> geschrieben
und über das USB-Kabel direkt auf das Gerät hinuntergeladen werden.

<p>Auch für einfache Robotik-Experimente ist die Arduino-Plattform
bestens geeignet. Schwieriger ist oft eine mechanisch befriedigende
Umsetzung selbst einfachster Robotik-Projekte. Diese Lücke kann
das fischertechnik-System schließen.

<p><h2><a id="1.2">1.2 Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>-Controller</a></h2>

<p>Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>-Controller wurde bewusst mechanisch und elektrisch an
den TX- und den TXT-Controller angelehnt, um ihn ebenfalls direkt mit
den aktuellen Robotics-Kästen kombinieren zu können. Gleichzeitig
wurde er softwareseitig mit dem Arduino-System kompatibel gehalten.

<figure id="IMG:1.4">
  
  <img src="controller/anschluesse_svg.png">
  <figcaption>Abbildung 1.4: Die Anschlüsse des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span></figcaption>
</figure>

<p><h3><a id="1.2.1">1.2.1 Mikrocontroller</a></h3>

<p>Das Herz des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> ist ein Mikrocontroller des Typs
ATmega32u4. Dieser Mikrocontroller wird von Microchip (ehemals Atmel)
hergestellt und findet auch im Arduino-Leonardo Verwendung. Sketches,
die für den Leonardo übersetzt wurden, sind oft direkt auf dem
<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> lauffähig.

<figure id="IMG:1.5">
  
  <img src="controller/schema_svg.png">
  <figcaption>Abbildung 1.5: Blockdiagramm des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span></figcaption>
</figure>

<p>Der ATmega32u4-Controller ist ein Mitglied der sogenannten AVR-Familie,
auf der die meisten Arduino-Bords basieren. Die AVR-Controller sind
klein, günstig und benötigen zum Betrieb nur wenig weitere Bauteile.
Ihr Speicher und ihre Rechenleistung reicht für den Betrieb sämtlicher
fischertechnik-Modelle der Roboticsreihe deutlich aus.

<p>Der ATmega32u4 verfügt über 32 Kilobytes nicht-flüchtigem
Flash-Speicher, der als Sketch-Programmspeicher verwendet wird sowie
2,5 Kilobytes internem RAM-Speicher zur Datenspeicherung. Der
Prozessortakt beträgt 16 Megahertz. Jeweils ein Sketch kann im
Flash-Speicher permanent gespeichert werden und bleibt auch erhalten
wenn der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> von der Spannungsversorgung getrennt wird.

<p>Der ATmega32u4 ist eines der wenigen Mitglieder der AVR-Familie, das
direkte USB-Unterstützung bereits auf dem Chip mitbringt. Auf diese
Weise ist der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> sehr flexibel als USB-Gerät am PC einsetzbar.

<p><h4>Bootloader</h4> 

<p>Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> wird mit einem im ATmega32u4 vorinstallierten
sogenannten Caterina-Bootloader ausgeliefert. Dieses Programm belegt
permanent vier der 32 Kilobytes Flash-Speicher des ATmega32u4 und kann
nicht ohne weiteres gelöscht oder verändert werden.

<p>Der Bootloader ermöglicht die Kommunikation mit dem PC und erlaubt es,
dass der PC Programmdaten in den verliebenden 28 Kilobytes
Flash-Speicher ablegen bzw. austauschen kann. Der Bootloader
ermöglicht auf diese Weise das Hinunterladen von Sketches in den
<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>.

<p>Dass der Bootloader aktiv ist und nicht etwa gerade ein Sketch
ausgeführt wird, ist am Zustand der internen LEDs erkennbar (siehe
<a href="controller.html#1.2.4">1.2.4</a>).

<p><h3><a id="1.2.2">1.2.2 USB-Anschluss</a></h3> 

<p>Die Verbindung zum PC zur Programmierung und Datenübertragung wird
über USB hergestellt. Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> verfügt über eine sogenannte
Mini-USB-Buchse und wird über ein handelsübliches Mini-USB-Kabel mit
dem PC verbunden.

<figure id="IMG:1.6">
  
  <img src="controller/usb-anschluss.jpg">
  <figcaption>Abbildung 1.6: Strom- und USB-Anschluss des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span></figcaption>
</figure>

<p><h3><a id="1.2.3">1.2.3 Reset-Taster</a></h3> 

<p>Normalerweise kann die Arduino-IDE durch entsprechende Kommandos über
den USB-Anschluss den Bootloader des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> aktivieren, um einen
neuen Sketch hinunterzuladen. Enthält ein hinuntergeladener Sketch
aber Fehler, die eine normale Programmausführung verhindern, dann kann
es passieren, dass die USB-Kommunikation während der normalen
Programmausführung nicht funktioniert und die Arduino-IDE den
<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> von sich aus nicht mehr ansprechen kann.

<p>Für diesen Fall verfügt der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> über einen Reset-Taster. Wird
dieser gedrückt, dann wird der Bootloader zwangsweise aktiviert und
die LEDs zeigen entsprechend den Start des Bootloaders an.

<p>Ein mit einem fehlerhaften Sketch versehener <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> kann daher
problemlos mit einem korrigierten Sketch versehen werden, indem kurz
vor dem Hinunterladen der Reset-Taster kurz gedrückt wird. Mehr Details
dazu finden sich im Abschnitt <a href="controller.html#1.3">1.3</a>.

<p><h3><a id="1.2.4">1.2.4 Interne LEDs</a></h3> 

<p>Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> verfügt über je eine grüne und rote interne Leuchtdiode
(LED). Die grüne Spannungsversorungs-LED zeigt an, dass der interne
5-Volt-Zweig mit Spannung versorgt ist und der Mikrocontroller des
<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> versorgt wird.

<p>Die rote LED steht für eigene Verwendung zur Verfügung und kann vom
Anwender aus eigenen Sketches heraus unter der Bezeichnung
<tt>LED_BUILTIN</tt> angesprochen werden (siehe Abschnitt
<a href="ersteschritte.html#3.1">3.1</a>).

<p>Die rote LED wird auch vom Caterina-Bootloader des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>
verwendet. Ist der Bootloader aktiv, so leuchtet die LED im
Sekundentakt sanft heller und dunkler (``fading'').

<p><h3><a id="1.2.5">1.2.5 Spannungsversorgung</a></h3> 

<p>Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> kann auf vier Arten mit Spannung versorgt werden:

<figure id="IMG:1.7">
  
  <img src="controller/ft_versorgungen.jpg">
  <figcaption>Abbildung 1.7: Für den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> empfohlene Original-fischertechnik-Stromversorgungen</figcaption>
</figure>

<p><dl>
<dt><b>USB</b></dt><dd> Über USB wird der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> immer dann versorgt, wenn
  keine weitere Stromversorgung angeschlossen ist. Die USB-Versorgung
  reicht allerdings nicht zum Betrieb der Analogausgänge. Lediglich
  die Eingänge können bei USB-Versorgung verwendet werden. Zusätzlich
  ist die Genauigkeit einer Widerstandsmessung an den Analogeingängen
  deutlich herab gesetzt (siehe <a href="controller.html#1.2.6">1.2.6</a>).
</dd><dt><b>Hohlstecker</b></dt><dd> Wird der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> per Hohlstecker z.B. durch das
  fischertechnik Power Netzgerät 505287<a href="#fn1"><sup>1</sup></a>  oder dem Netzteil aus
  dem fischertechnik Power-Set 505283<a href="#fn2"><sup>2</sup></a>  mit 9 Volt versorgt, so
  wird der gesamte <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> daraus versorgt und der USB-Anschluss
  wird nicht belastet. Die Analogausgänge sind in diesem Fall
  benutzbar und die Widerstandsmessung an den Analogeingängen erfolgt
  mit voller Genauigkeit. Für den Einsatz von Fremdnetzgeräten bietet
  fischertechnik unter der Artikelnummer 134863<a href="#fn3"><sup>3</sup></a>  einen Adapter
  von üblichen 5mm-Hohlsteckern auf den von fischertechnik verwendeten
  3,45mm-Stecker an.
</dd><dt><b>9V=-Eingang</b></dt><dd> Eine Versorgung des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> z.B. per
  Batterie-Set oder mit dem Akku aus dem Akku-Set 34969<a href="#fn4"><sup>4</sup></a>  entspricht der
  Versorgung per Hohlstecker. Wird der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> sowohl über den
  9V=-Eingang als auch per Hohlstecker versorgt, dann erfolgt die
  Versorgung aus der Quelle, die die höhere Spannung liefert. Eine
  Rückspeisung in den Akku oder eine Ladung des Akkus findet nicht
  statt.
</dd><dt><b>I²C</b></dt><dd> Über den I²C-Anschluss versorgt der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> in erster
  Linie andere angeschlossene Geräte wie kleine Displays oder
  Sensoren. Es ist aber auch möglich, ihn selbst über diesen Anschluss
  zu versorgen. Es bestehen dabei die gleichen Beschränkungen wie bei
  der Versorgung über USB. Auf diese Weise ist zum Beispiel die
  Versorgung zweier gekoppelter <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>s aus einer einzigen Quelle
  möglich (siehe Abschnitt <a href="experimente.html#6.13.5">6.13.5</a>).
</dd></dl>

<figure id="IMG:1.8">
  
  <img src="controller/stecker_svg.png">
  <figcaption>Abbildung 1.8: 3,45mm fischertechnik-Hohlstecker</figcaption>
</figure>

<p><font color="red">Vorsicht</font> ist bei der Verwendung unbekannter oder sehr
alter Spannungsquellen geboten. Oftmals weichen die aufgedruckten
Nennspannungen weit von der Realität ab. Das in Abbildung
<a href="controller.html#IMG:1.9">1.9</a> abgebildete Netzteil liefert am 6,8-Volt-Ausgang
eine Leerlaufspannung von über 27 Volt. Ein einfaches Multimeter zeigt
noch moderate 9,4 Volt an und könnte den Eindruck erwecken, dass sich
dieses Netzteil zum Betrieb des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> eignet. Erst das
Oszilloskop bringt den genauen Spannungsverlauf zu Tage und zeigt,
dass die Spannung kurzfristig sogar 27,2 Volt erreicht. Während Ein-
und Ausschaltvorgängen können noch wesentlich höhere Spannungen
auftreten und den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> beschädigen.

<figure id="IMG:1.9">
  
  <figure><img src="controller/ft_trafo_1.jpg"><figcaption>(a) Das Multimeter zeigt gute 9 Volt an</figcaption></figure> 
  <figure><img src="controller/ft_trafo_2.jpg"><figcaption>(b) Das Oszilloskop zeigt Spitzen von über 27 Volt</figcaption></figure>
  <figcaption>Abbildung 1.9: Vorsicht: Ein alter fischertechnik-Trafo liefert über 27V am 6,8-Volt-Ausgang und ist für den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> ungeeignet</figcaption> 
</figure>

<p>Aus diesem Grund sollte man bei Einsatz solcher alten oder unbekannten
Spannungsquellen sehr vorsichtig sein und im Zweifelsfall auf den
Einsatz verzichten.

<figure id="IMG:1.10">
  
  <img src="controller/alte_trafos.jpg">
  <figcaption>Abbildung 1.10: Alte und für den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> ungeeignete Stromversorgungen</figcaption>
</figure>

<p>Im Zweifel sollte unbedingt eine aktuelle Spannungsversorung von
fischertechnik eingesetzt werden. Das aktuelle Fischertechnik Power
Netzgerät 9V 505287<a href="#fn5"><sup>5</sup></a>  ist bestens geeignet, ebenso wie der Akku
aus dem Akku-Set 34969<a href="#fn6"><sup>6</sup></a>  oder ein 9-Volt-Block im Batteriehalter.

<figure id="IMG:1.11">
  
  <img src="controller/dritthersteller.jpg">
  <figcaption>Abbildung 1.11: Für den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> geeignetes Universalnetzteil aus dem Onlineversand</figcaption> 
</figure>

<p>Soll es unbedingt ein Fremdgerät sein, so ist auf eine stabilisierte
9Volt-Spannung zu achten. Die Stromstärke sollte 1,5 Ampere nicht
unterschreiten, um auch kräftige Motoren betreiben zu können. Ein
Beispiel das in Abbildung <a href="controller.html#IMG:1.11">1.11</a> dargestellte
Universal-Schaltnetzteil aus dem
Reichelt-Onlineversand<a href="#fn7"><sup>7</sup></a> .

<p><h3><a id="1.2.6">1.2.6 Anschlüsse</a></h3>

<p>Die Anschlüsse des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> teilen sich in die
fischertechnik-kompatiblen Ein- und Ausgänge auf, die für die üblichen
2,6mm-Einzelstecker geeignet sind, sowie die üblichen Steckverbinder
aus dem Computerbereich. Die fischertechnik-kompatiblen Ein- und
Ausgänge sind identisch zum fischertechnik-TXT-Controller angeordnet.
Verdrahtungsschemata für den TXT können daher in der Regel direkt
übernommen werden.

<p><h4>Analoge Eingänge</h4> 

<p>Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> verfügt über acht analoge Eingänge <tt>I1</tt> bis
<tt>I8</tt>, über die Spannungen von 0 bis 10 Volt sowie Widerstände
von 0 bis über 10 Kiloohm erfasst werden können.

<p>Die Eingänge sind über hochohmige Serienwiderstände gegen Kurzschlüsse
sowie Über- und Unterspannung abgesichert.

<p>Jeder Eingang ist mit einem eigenen Analogeingang des
ATmega32u4-Mikrocontrollers verbunden. Die Analogwerterfassung kann
mit bis zu 10 Bit Auflösung erfolgen (entsprechend einem Wertebereich
0 bis 1023) und wird direkt in der Hardware des Mikrocontrollers
durchgeführt.

<p>Ein Spannungsteiler erweitert den Eingangsspannungsbereich des
Mikrocontrollers von 0 bis 5 Volt auf den bei fischertechnik genutzten
Bereich von 0 bis 10 Volt. Alle an fischertechnik-Modellen
auftretenden Spannungen können damit erfasst werden.

<p>Zur Widerstandsmessung kann kann jeder Eingang <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>-intern mit
einem Widerstand gegen 5 Volt verschaltet werden. Dieser Widerstand
wirkt mit einem externen Widerstand als Spannungsteiler und aus der am
Mikrocontroller gemessenen Spannung kann der Wert des extern
angeschlossenen Widerstands gemessen werden. Alle von
fischertechnik-Modellen üblicherweise verwendeten Widerstände können
so erfasst werden.

<p>Die analogen Eingänge sind nicht auf eine externe 9-Volt-Versorgung
angewiesen, sondern funktionieren auch bei der Stromversorgung über
den USB-Anschluss des PC. Allerdings sinkt in diesem Fall die
Genauigkeit der Widerstandsmessung signifikant.

<p><h4>Analoge Ausgänge</h4>

<p>Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> verfügt über acht analoge Ausgänge <tt>O1</tt> bis
<tt>O8</tt>. Diese Ausgänge werden über zwei spezielle
Treiberbausteine im <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> angesteuert. Die Treiberbausteine
können jeden der acht Ausgänge unabhängig steuern. Sie sind identisch
zu denen, die fischertechnik in den TX- und TXT-Controllern
einsetzt. Die Ausgänge sind daher kompatibel zu allen
fischertechnik-Motoren und -Aktoren, die auch am TX- und
TXT-Controller betrieben werden können. Der maximal pro Ausgang
verfügbare Strom beträgt 600mA bis 1,2A.

<p>Die Ausgänge sind bei einer reinen USB-Stromversorgung des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>
nicht verfügbar.

<p>Der verwendete Treiberbaustein MC33879 ist kurzschlussfest und robust
gegen Über- und Unterspannung an den Ausgängen.

<p>Alle acht Ausgänge können unabhängig voneinander gegen Masse oder
Eingangsspannung sowie hochohmig geschaltet werden. Je zwei
Einzelausgänge können zu einem Motorausgang kombiniert werden. Die
Einzelausgänge <tt>O1</tt> und <tt>O2</tt> bilden dabei den Motorausgang
<tt>M1</tt>, <tt>O3</tt> und <tt>O4</tt> bilden <tt>M2</tt> und so weiter.

<p>Die Analogwerte an den Ausgängen werden durch eine sogenannte
Pulsweitenmodulation (PWM) erzeugt. Dabei werden die Ausgänge
kontinuierlich schnell ein- und ausgeschaltet, so dass Motoren, Lampen
und andere träge Verbraucher dem Signal nicht folgen können, sondern
sich entsprechend des Mittelwerts verhalten. Dieses Verfahren wird in
gleicher Weise auch im TX- und TXT-Controller angewendet.

<p>Beide MC33879 werden vom Mikrocontroller des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> intern über
dessen sogenannte SPI-Schnittstelle angeschlossen. Da dadurch die
speziellen PWM-Ausgänge des Mikrocontrollers nicht zur Erzeugung der
der Pulsweitenmodulation herangezogen werden können muss das
PWM-Signal durch den Sketch bzw. die verwendeten Software-Bibliotheken
(siehe Kapitel <a href="bibliotheken.html#9">9</a>) selbst erzeugt werden. Die sogenannte
PWM-Frequenz wird dabei durch den verwendeten Sketch bestimmt und kann
beliebig variiert werden.

<p>Mehr Informationen zum Thema PWM finden sich in Abschnitt
<a href="experimente.html#6.3">6.3</a>.

<p><h4>Zählereingänge</h4>  

<p>Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> verfügt über vier spezielle Zählereingänge <tt>C1</tt> bis
<tt>C4</tt>. Diese Eingänge können rein digitale Signale erfassen und mit
hoher Geschwindigkeit Ereignisse auswerten. Die maximal erfassbare
Signalrate liegt je nach Sketch bei mehreren 10.000 Ereignissen pro
Sekunde.

<p>Die Zählereingänge sind kompatibel zu den Encodern der
fischertechnik-Encoder-Motoren und können unter anderem zur
Drehwinkelauswertung sowie zur Drehzahlbestimmung herangezogen werden.

<p>Zählereingang <tt>C1</tt> verfügt zusätzlich über die Möglichkeit,
einen fischertechnik ROBO TX Ultraschall-Distanzsensor 133009<a href="#fn8"><sup>8</sup></a> 
auszuwerten. 

<p>Hinweis: Es gibt zusätzlich zum dem hier beschriebenen
Ultraschallsensor mit dreiaddrigem Anschliusskabel einen sehr alten
Sensor mit vierpoligem Kabel. Dieser sehr alte Sensor seit langem
nicht mehr erhältliche Sensor ist zum <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> nicht kompatibel (und
auch zu keinem der aktuellen Original-fischertechnik-Controller).

<figure id="IMG:1.12">
  
  <img src="controller/ultraschall_svg.png">
  <figcaption>Abbildung 1.12: Anschluss des Ultraschallsensors 133009</figcaption>
</figure>

<p><h4>I²C-Anschluss</h4> 

<p>Der I²C-Anschluss ist elektrisch und mechanisch zu dem des
fischertechnik-TX-Controllers kompatibel. Der dort aus dem Gerät
herausgeführte sogenannte I²C-Bus findet auch im Arduino-Umfeld
häufige Verwendung und erlaubt den Anschluss passender
Elektronikkomponenten wie Sensoren, Analog-Digital-Wandler, Displays
und ähnlich. Außerdem ist über den I²C-Bus eine Kopplung mehrerer
<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>s möglich sowie die Kopplung des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> mit dem
TX-Controller und dem TXT-Controller wie in Abschnitt <a href="experimente.html#6.13">6.13</a>
beschrieben.

<figure id="IMG:1.13">
  
  <img src="controller/i2c_svg.png">
  <figcaption>Abbildung 1.13: Buchsen- und Kabelbelegung des I²C-Bus am <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span></figcaption>
</figure>

<p>Die Signale auf dem I²C-Anschluss nutzen wie am TX-Controller einen
5-Volt-Pegel. Zusätzlich werden aus der Spannungsversorgung des
<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> 5 Volt zur Versorgung angeschlossener Komponenten
bereitgestellt. Aus dem 5 Volt-Ausgang dürfen maximal 100mA entnommen
werden, um die <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>-interne Spannungsversorgung nicht zu
überlasten

<figure id="IMG:1.14">
  
  <img src="controller/i2c-kappe.jpg">
  <figcaption>Abbildung 1.14: Entfernen der Schutzkappe vom I²C-Anschluss des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span></figcaption>
</figure>

<p><font color="red">Achtung!</font> Der fischertechnik-TXT-Controller sowie für
den Betrieb am TXT vorgesehene Komponenten sind aufgrund dessen 3,3
Volt-Signal-Pegel nicht direkt mit dem <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> kompatibel. Eine
direkte Verbindung zwischen TXT und <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> kann den TXT
beschädigen. Sollen der TXT oder für den Betrieb am TXT vorgesehene
Komponenten am <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> verwendet werden, so sind unbedingt passende
I²C-Pegelanpassung zwischenzuschalten wie in Abschnitt
<a href="experimente.html#6.13.5">6.13.5</a> beschrieben.

<p><font color="red">Achtung!</font> Die auf dem I²C-Anschluss liegenden
Signale sind direkt und ungeschützt mit dem Mikrocontroller des
<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> bzw. mit dessen Spannungsversorgung verbunden.  Werden an
diesem Anschluss Kurzschlüsse verursacht oder Spannungen über 5V
angelegt, dann kann der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> zerstört werden. Der
I²C-Anschluss sollte daher nur von erfahrenen Anwendern verwendet
werden. Aus diesem Grund wird der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> mit einer Schutzkappe auf
dem I²C-Anschluss vertrieben. Diese Kappe ist bei Bedarf vorsichtig
mit einem flachen Schraubendreher zu entfernen.

<p><h3><a id="1.2.7">1.2.7 Variante mit internem OLED-Display</a></h3> 

<p>Es gibt Varianten des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>, die bereits über ein eingebautes
OLED-Display verfügen. Das Display hat eine Auflösung von 128 * 32
Pixel und ist intern am I²C-Bus angeschlossen.

<figure id="IMG:1.15">
  
  <img src="controller/oled.jpg">
  <figcaption>Abbildung 1.15: Raumschiffanimation auf dem intenen OLED des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span></figcaption>
</figure>

<p>Der OLED-<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> verfügt über einen angepassten Bootloader, der
direkt nach dem Einschalten das Display initialisiert und einen
ftDuino-Schriftzug einblendet. Da der Bootloader das Display aktiv
anspricht bildet der OLED-<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> immer einen I²C-Busmaster. Ein
<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> mit eingebautem Display eignet sich daher nur sehr
eingeschränkt dafür, selbst als I²C-Client zu arbeiten und selbst
von einem anderen I²C-Master angesprochen zu werden. Er kann jedoch
selbst uneigeschränkt als Master arbeiten und z.B. einen weiteren
Display-losen <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> am I²C ansprechen. Zusätzliche externe
I²C-Geräte lassen sich wie gehabt anschließen.

<figure id="IMG:1.16">
  
  <img src="controller/adafruit_gfx.png">
  <figcaption>Abbildung 1.16: Die Adafruit-GPX-Bibliothek im Bibliotheksmanager der Arduino-IDE</figcaption>
</figure>

<p>Die <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>-Installation bringt unter
<a href="https://github.com/harbaum/ftduino/tree/master/ftduino/libraries/Ftduino/examples/InternalOLED"><tt><span style="background-color:#f0f0f0;">Datei</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">Beispiele</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">Ftduino</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">InternalOLED</span></tt></a> mehrere Beispiele mit, die jeweils über
eigene Varianten der <tt>FtduinoDisplay.cpp</tt>-Bibliothek
verfügen. Alle Beispiele benötigen zusätzlich die über den
Bibliotheks-Manager der Arduino-IDE mit wenigen Klicks zu
installierende ``Adafruit GFX Library''.

<p>Das Beispiel <a href="https://github.com/harbaum/ftduino/tree/master/ftduino/libraries/Ftduino/examples/InternalOLED/Ship3D"><tt><span style="background-color:#f0f0f0;">Datei</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">Beispiele</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">Ftduino</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">InternalOLED</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">Ship3D</span></tt></a> bringt eine
einfache und schnelle Variante dieser Bibliothek mit. Sie sollte immer
dann verwendet werden, wenn keine weiteren I²C-Geräte am <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>
betrieben werden und es auf einen schnellen Bildaufbau ankommt.

<p>Das Beispiel <a href="https://github.com/harbaum/ftduino/tree/master/ftduino/libraries/Ftduino/examples/InternalOLED/Ship3DWire"><tt><span style="background-color:#f0f0f0;">Datei</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">Beispiele</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">Ftduino</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">InternalOLED</span></tt> &#9658; <tt><span style="background-color:#f0f0f0;">Ship3DWire</span></tt></a> dagegen basiert
auf der Arduino-Wire-Bibliothek und der Bildaufbau ist hier deutlich
langsamer. Dafür wird zum Zugriff auf den I²C-Bus die
Wire-Bibliothek verwendet und ein Betrieb zusammen mit anderen
ebenfalls durch die Wire-Bibliothek angesteuerten I²C-Sensoren ist
möglich. Diese Variante der <tt>FtduinoDisplay.cpp</tt>-Bibliothek
kommt auch dann zum Einsatz, wenn am OLED-<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> weitere
<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>s über I²C zur Bereitstellung zusätzlicher Ein- und
Ausgänge angeschlossen sind.

<p>Das interne OLED-Display belegt die Adresse <tt>0x3C</tt> (dezimal 60)
und kann daher nicht ohne weiteres parallel mit anderen OLED-Displays
unter dieser Adresse betrieben werden.

<p><h3><a id="1.2.8">1.2.8 Hinweise für Arduino-erfahrene Nutzer</a></h3>

<p>Es gibt ein paar fundamentale Unterschiede zwischen dem klassischen
Arduino und dem <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>. In erster Linie sind dies die Schutz- und
Treiberschaltungen, die beim <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> für die
fischertechnik-Kompatibilität der Anschlüsse sorgt. Diese Schaltungen
sind der Grund, warum man die Ein- und Ausgänge des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> nicht
mit den Arduino-üblichen <tt>pinMode()</tt> und
<tt>digitalWrite()</tt>-Funktionen ansprechend kann. Diese Funktionen
sind darauf ausgelegt, direkt Anschlüsse des
ATmega32u4-Mikrocontrollers zu steuern und berücksichtigen nicht, dass
der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> zusätzliche Schaltungen beinhaltet.

<p>Aus diesem Grund werden die fischertechnik-kompatiblen Ein- und
Ausgänge des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> über eigene Bibliotheken angesteuert, wie in
Kapitel <a href="bibliotheken.html#9">9</a> beschrieben.

<p>Erfahrene Nutzer können unter Umgehung dieser Bibliotheken nach wie
vor auch direkt mit der Hardware des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> kommunizieren. Die
Schaltpläne im Anhang <a href="anhang.html#A">A</a> liefern alle dafür nötige
Information.

<p><h2><a id="1.3">1.3 Problemlösungen</a></h2> 

<p><h3><a id="1.3.1">1.3.1 Die grüne Leuchtdiode im <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> leuchtet nicht</a></h3> 

<p>Zunächst sollte der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> von allen Verbindungen getrennt und
ausschließlich über den USB-Anschluss mit dem PC verbunden werden.
Die grüne Leuchtdiode im <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> muss sofort aufleuchten. Tut sie
das nicht, dann sollte ein anderer PC bzw. ein anderer USB-Anschluss
probiert werden.

<p>Hilft das nicht, dann ist zunächst das USB-Kabel zu
prüfen. Funktionieren andere Geräte an diesem Kabel? Gegebenenfalls
muss das Kabel ausgetauscht werden.

<p><h3><a id="1.3.2">1.3.2 Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> taucht am PC nicht als <tt>COM:</tt>-Port auf</a></h3> 

<p>Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> wird nicht mehr vom PC erkannt und es wird kein
<tt>COM:</tt>-Port angelegt.

<p>Leuchtet die grüne Leuchtdiode am <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>? Falls nicht sollte wie
unter <a href="controller.html#1.3.1">1.3.1</a> verfahren werden.

<p>Leuchtet die grüne Leuchtdiode, dann sollte ein kurzer Druck auf den
Reset-Taster (siehe <a href="controller.html#1.2.3">1.2.3</a>) den Bootloader des <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> für
einige Sekunden aktivieren. Erkennbar ist dies am langsamen Ein- und
Ausblenden der roten Leuchtdiode wie in Abschnitt <a href="controller.html#1.2.4">1.2.4</a>
beschrieben. In dieser Zeit sollte der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> vom PC erkannt
werden. Dies wird u.a. unter Windows im Gerätemanager wie im Abschnitt
<a href="installation.html#2.1.3">2.1.3</a> beschrieben angezeigt.

<p>Wird der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> nach einem Reset erkannt, aber verschwindet nach
ein paar Sekunden aus der Ansicht des Gerätemanagers oder wird als
unbekanntes Gerät angezeigt, dann wurde wahrscheinlich ein
fehlerhafter Sketch auf den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> geladen und die Arduino-IDE ist
nicht in der Lage, sich eigenständig mit dem <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> zu verbinden.
In diesem Fall sollte man das Blink-Beispiel (siehe Abschnitt
<a href="ersteschritte.html#3.1">3.1</a>) in der Arduino-IDE öffnen, den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> per
kurzem Druck auf den Reset-Taster in den Bootloader-Modus versetzen und
direkt danach die Download-Schaltfläche in der Arduino-IDE drücken.
Sobald der funktionierende Sketch geladen wurde wird der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>
auch ohne manuelle Druck auf den Reset-Taster wieder von PC erkannt
und der entsprechende <tt>COM:</tt>-Port taucht wieder auf.

<p>Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> bleibt nur wenige Sekunden im Bootloader und kehrt
danach in den normalen Sketch-Betrieb zurück. Zwischen dem Druck auf
den Reset-Knopf und dem Start des Downloads aus der Arduino-IDE sollte
daher möglichst wenig Zeit vergehen.

<p><h3><a id="1.3.3">1.3.3 Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> funktioniert, aber die Ausgänge nicht</a></h3>

<p>Um die Ausgänge zu benutzen muss der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> mit einer
9-Volt-Spannungsquelle entweder über den Hohlstecker-Anschluss oder
über die üblichen fischertechnik-Stecker verbunden sein. Verfügt der
<span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> über keine ausreichende 9-Volt-Versorgung, so können die
Ausgänge nicht betrieben werden. Da der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> selbst schon mit
geringerer Spannung läuft ist dessen Funktion kein sicheres Indiz
dafür, dass eine ausreichende 9-Volt-Versorgung vorhanden ist.

<p>Ist der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> über USB mit dem PC verbunden, dann versorgt er
sich bei mangelhafter oder fehlender 9-Volt-Versorgung von dort. Geht
der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> ganz aus, sobald man die USB-Verbindung trennt, dann
ist keine 9-Volt-Versorgung gegeben und es muss sichergestellt werden,
dass Polarität und Spannung korrekt bzw. ausreichend
sind. Gegebenenfalls muss die Batterie ausgetauscht oder der
verwendete Akku geladen werden.

<p><h3><a id="1.3.4">1.3.4 Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> lässt sich nicht flashen</a></h3> 

<p>Es kommt vor, dass der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> zwar vom PC (zeitweise) erkannt
wird, sich aber einfach nicht flashen lässt. Die Ursachen dafür können
vielfältig sein, in der Regel ist es aber eine der folgenden zwei
Ursachen:

<p><ul>
<li> Die USB-Verbindung ist elektrisch oder mechanisch instabil
</li><li> Ein anderes Programm auf dem Computer kommuniziert ebenfalls mit dem <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>  
</li></ul>

<p>Mechanisch oder elektrisch instabile Verbindungen werden in der Regel
von lose sitzenden USB-Kabeln verursacht. Meistens reicht es in diesem
Fall, leicht am USB-Kabel zu wacheln, um den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> kurz die
Spannung verlieren und neu starten zu lassen. Passiert das während des
Sketch-Uploads, so ist der Sketch nicht lauffähig und der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>
wird wie in Abschnitt <a href="controller.html#1.3.2">1.3.2</a> beschrieben nur noch nach Druck
auf den Reset-Taster vom PC erkannt.

<p>In der Regel flackert dabei auch die Power-LED etwas. In Abbildung
<a href="controller.html#IMG:1.17">1.17</a> wurde der entsprechende Fehler provoziert, indem
während des Flashens der USB-Stecker abgezogen wurde. Die Verwendung
eines anderen USB-Kabels schafft dann in der Regel Abhilfe.

<figure id="IMG:1.17">
  
  <img src="controller/fehler_beim_hochladen.png">
  <figcaption>Abbildung 1.17: Fehler beim Hochladen</figcaption> 
</figure>

<p>Liegt kein Wackelkontakt am USB-Port vor, dann geben die ``ausführlichen
Ausgaben'' beim Upload ggf. zusätzliche Informationen. Diese Ausgaben
werden in den Voreinstellungen aktiviert.

<figure id="IMG:1.18">
  
  <img src="controller/ausfuehrliche_ausgabe.png">
  <figcaption>Abbildung 1.18: Ausführliche Debug-Ausgaben während des Hochladens aktivieren</figcaption> 
</figure>

<p>Eine mögliche Ausgabe sieht danach so aus:

<pre>
     Writing | #####################avrdude: error: programmer did not respond to command: set addr
     avrdude: error: programmer did not respond to command: write block
     ## ***failed;  
      ***failed;  
      ***failed;  
      ***failed;  
      ***failed;  
      ***failed;  
      ***failed;  
      ***failed;  
      ***failed;  
      ***failed;  
     avrdude: Error: butterfly programmer uses avr_write_page() but does not
     provide a cmd() method.
      *** page 127 (addresses 0x0000 - 0x007f) failed to write
      ***failed;  
      ***failed;  
      ***failed;  
      ***failed;
</pre>
Hier treten mitten in der Datenübertragung Fehler auf. Am häufigsten
tritt dies auf Linux-PCs auf. Ursache ist in der Regel der sogenannte
Modem-Manager, eine Software, die zur Verwaltung von Modems verwendet
wird und sich mit dem <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> verbindet, um festzustellen, ob es
sich bei ihm um ein Modem handelt.  Einige Tipps dazu finden sich
bereits in Abschnitt <a href="installation.html#2.1.4">2.1.4</a>.

<p>Neben der dort beschriebenen Installation der Datei
<tt>/etc/udev/rules.d/99-ftduino.rules</tt> hilft es oft, den
Modem-Manager-Dienst per <tt>systemctrl</tt>-Kommando zunächst
testweise zu stoppen:

<pre>
       sudo systemctl stop ModemManager.service
</pre>
bzw. bei Erfolg dauerhaft:

<pre>
       sudo systemctl disable ModemManager.service
</pre>
Dieses Problem ist nicht <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>-spezifisch, sondern betrifft
z.B. auch den Arduino-Leonardo. Entsprechende Lösungen im Internet bei
Leonardo-Problemen lassen sich daher oft auch auf den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span>
übertragen.

<p><h3><a id="1.3.5">1.3.5 Der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> wird als Leonardo erkannt</a></h3> 

<p>Es ist möglich, dass der <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> sich seiner Identität nicht so ganz
sicher zu sein scheint und in der IDE statt als <tt>ftDuino</tt>
als Leonardo angeszeigt wird wie in Abbildung <a href="controller.html#IMG:1.19">1.19</a> beispielhaft
auf einem Linux-System zu sehen.

<figure id="IMG:1.19">
  
  <img src="controller/ftduino_als_leonardo.png">
  <figcaption>Abbildung 1.19: Die IDE erkennt den <span style="color: red">f</span><span style="color: blue">t</span><span style="color: darkcyan">Duino</span> als Leonardo</figcaption> 
</figure>

<p>Das passiert, wenn man vor dem Upload eines Sketches in der IDE nicht den
<tt>ftDuino</tt> als Board ausgewählt hatte sondern den Arduino Leonardo.

<p>Dieser Zustand ist völlig unkritisch. Sobald man das Board wie unter
anderem in Abschnitt <a href="installation.html#2.2.2">2.2.2</a> beschrieben auf
<tt>ftDuino</tt> einstellt wird dieser nach dem nächsten erfolgreichen
Sketch-Upload wieder als <tt>ftDuino</tt> erkannt.
<hr><small>
<a id="fn1">1) </a>fischertechnik-Datenbank: <a href="https://ft-datenbank.de/tickets?fulltext=505287">https://ft-datenbank.de/tickets?fulltext=505287</a><br>
<a id="fn2">2) </a>fischertechnik-Datenbank: <a href="https://ft-datenbank.de/tickets?fulltext=505283">https://ft-datenbank.de/tickets?fulltext=505283</a><br>
<a id="fn3">3) </a>fischertechnik-Datenbank: <a href="https://ft-datenbank.de/tickets?fulltext=134863">https://ft-datenbank.de/tickets?fulltext=134863</a><br>
<a id="fn4">4) </a>fischertechnik-Datenbank: <a href="https://ft-datenbank.de/tickets?fulltext=34969">https://ft-datenbank.de/tickets?fulltext=34969</a><br>
<a id="fn5">5) </a>fischertechnik-Datenbank: <a href="https://ft-datenbank.de/tickets?fulltext=505287">https://ft-datenbank.de/tickets?fulltext=505287</a><br>
<a id="fn6">6) </a>fischertechnik-Datenbank: <a href="https://ft-datenbank.de/tickets?fulltext=34969">https://ft-datenbank.de/tickets?fulltext=34969</a><br>
<a id="fn7">7) </a>Reichelt MW 3R15GS <a href="https://www.reichelt.de/universal-schaltnetzteil-18-w-3-12-v-1500-ma-mw-3r15gs-p87340.html">https://www.reichelt.de/universal-schaltnetzteil-18-w-3-12-v-1500-ma-mw-3r15gs-p87340.html</a><br>
<a id="fn8">8) </a>fischertechnik-Datenbank: <a href="https://ft-datenbank.de/tickets?fulltext=133009">https://ft-datenbank.de/tickets?fulltext=133009</a><br>
</small>
<footer>
<p><a href="">▲  nach oben</a><br><a href="http://ftduino.de/">ftDuino</a> manual - controller</p>
<p class="copy">(c) 2017-2019 Till Harbaum</p>
</footer>
</body></html>